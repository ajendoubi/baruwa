{% extends "base.html" %}
{% block headers %}
<script type="text/javascript" language="javascript" src="/static/js/jquery-1.4.min.js"></script>
<script type="text/javascript" charset="utf-8">
var rj;
var ax_error = false;
</script>
<script type="text/javascript" language="javascript" src="/static/js/jquery.address-1.1.min.js"></script>
<script type="text/javascript" language="javascript" src="/static/js/lists.js"></script>
{% endblock headers %}
{% block submenu %}
<ul>
{% ifequal list_kind 1 %}
  <li><a href="/lists/2/">Blacklist</a></li>
{%else%}
  <li><a href="/lists/1/">Whitelist</a></li>
{%endifequal%}
  <li><a href="/lists/add/">Add to List</a></li>
</ul>
{% endblock submenu %}
{% block title %}
List management{%if is_paginated%} {% load pagination_heading %}{% pagination_heading %}{%endif%}
{% endblock title %}
{% block heading %}
{% ifequal list_kind 1 %}Whitelist{%else%}Blacklist{%endifequal%}{%if is_paginated%} :: <span id="pagination_info">{% pagination_heading %}</span>{%endif%}
{% endblock heading %}
{% block content %}
<table id="lists" class="maillog">
    <thead>
        <tr class="lists">
        <td id="top-pagination" class="top-pagination" colspan="4">{% if is_paginated %}{% pagination_heading %}{% load paginator %}{% paginator 3 %}{% endif %}</td>
        </tr>
        <tr class="header">
            {% load sorter %}
            {% sorter "id" "#" %}
            {% sorter "to_address" "To" %}
            {% sorter "from_address" "From" %}
            <th class="first-t">
            Action
            </th>
        </tr>
    </thead>
    <tfoot>
        <tr class="header">
        <td colspan="4" class="pagination">
        {% ifnotequal order_by "id" %}
        <div id="filterbox">
        <form method="post" action="/{{app}}/{{direction}}/{{order_by}}/">
        Filter {%ifequal order_by "to_address"%}To:{%endifequal%}{%ifequal order_by "from_address"%}From:{%endifequal%}
        <select name="query_type">
        <option value="1"{%ifequal query_type 1%} selected="selected"{%endifequal%}>containing</option>
        <option value="2"{%ifequal query_type 2%} selected="selected"{%endifequal%}>excluding</option>
        </select>
        <input name="search_for" type="text" value="{{search_for}}" size="25" />
        <input type="submit" value="GO" />
        </form>
        </div>
        {%endifnotequal%}
        <div id="paginator">
        {% if is_paginated %}{% pagination_heading %}{% load paginator %}{% paginator 3 %}{% endif %}
        </div>
        </td>
        </tr>
    </tfoot>
    <tbody>
        {% if object_list %}
            {% load messages_extras %}
            {% for listitem in object_list %}
            <tr class="lists">
                <td class="lists first-t{%ifequal order_by "id"%} ordered_by{%endifequal%}">{{listitem.id}}</td>
                <td class="lists first-t{%ifequal order_by "to_address"%} ordered_by{%endifequal%}">{{listitem.to_address|tds_email_list}}</td>
                <td class="lists first-t{%ifequal order_by "from_address"%} ordered_by{%endifequal%}">{{listitem.from_address}}</td>
                {% ifnotequal listitem.from_address "127.0.0.1" %}
                <td class="lists first-t"><a href="/lists/delete/{{list_kind}}/{{listitem.id}}/">Delete</a></td>
                {% else %}
                <td class="lists first-t">=builtin=</td>
                {% endifnotequal %}
            </tr>
            {% endfor %}
        {% else %}
            <tr>
                <td class="align_center" colspan="4">No items at the moment</td>
            </tr>
        {% endif %}
    </tbody>
</table>
{% endblock content %}
